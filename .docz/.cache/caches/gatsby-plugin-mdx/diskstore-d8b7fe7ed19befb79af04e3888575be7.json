{"expireTime":9007200836242271000,"key":"gatsby-plugin-mdx-entire-payload-dee17ec39b1f5242931ba4f849f644ec-","val":{"mdast":{"type":"root","children":[{"type":"import","value":"import DefaultLayout from \"/Users/dennis.okeeffe/Project-Imposter/developer-notes/node_modules/gatsby-theme-docz/src/base/Layout.js\"","position":{"start":{"line":3,"column":1,"offset":2},"end":{"line":3,"column":133,"offset":134},"indent":[]}},{"type":"export","default":true,"value":"export default DefaultLayout","position":{"start":{"line":5,"column":1,"offset":136},"end":{"line":5,"column":29,"offset":164},"indent":[]}},{"type":"heading","depth":1,"children":[{"type":"text","value":"5. Packaging and Deploying on Kubernetes","position":{"start":{"line":8,"column":3,"offset":169},"end":{"line":8,"column":43,"offset":209},"indent":[]}}],"position":{"start":{"line":8,"column":1,"offset":167},"end":{"line":8,"column":43,"offset":209},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"5.1 Intro to Helm","position":{"start":{"line":10,"column":4,"offset":214},"end":{"line":10,"column":21,"offset":231},"indent":[]}}],"position":{"start":{"line":10,"column":1,"offset":211},"end":{"line":10,"column":21,"offset":231},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Helm is the best way to find, share and use software built for Kubernetes.","position":{"start":{"line":12,"column":1,"offset":233},"end":{"line":12,"column":75,"offset":307},"indent":[]}}],"position":{"start":{"line":12,"column":1,"offset":233},"end":{"line":12,"column":75,"offset":307},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Package manager for Kubernetes.","position":{"start":{"line":14,"column":3,"offset":311},"end":{"line":14,"column":34,"offset":342},"indent":[]}}],"position":{"start":{"line":14,"column":3,"offset":311},"end":{"line":14,"column":34,"offset":342},"indent":[]}}],"position":{"start":{"line":14,"column":1,"offset":309},"end":{"line":14,"column":34,"offset":342},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Helps you manage Kubernetes apps.","position":{"start":{"line":15,"column":3,"offset":345},"end":{"line":15,"column":36,"offset":378},"indent":[]}}],"position":{"start":{"line":15,"column":3,"offset":345},"end":{"line":15,"column":36,"offset":378},"indent":[]}}],"position":{"start":{"line":15,"column":1,"offset":343},"end":{"line":15,"column":36,"offset":378},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Maintained by CNCF.","position":{"start":{"line":16,"column":3,"offset":381},"end":{"line":16,"column":22,"offset":400},"indent":[]}}],"position":{"start":{"line":16,"column":3,"offset":381},"end":{"line":16,"column":22,"offset":400},"indent":[]}}],"position":{"start":{"line":16,"column":1,"offset":379},"end":{"line":16,"column":22,"offset":400},"indent":[]}}],"position":{"start":{"line":14,"column":1,"offset":309},"end":{"line":16,"column":22,"offset":400},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"To use, download the Helm client.","position":{"start":{"line":18,"column":1,"offset":402},"end":{"line":18,"column":34,"offset":435},"indent":[]}}],"position":{"start":{"line":18,"column":1,"offset":402},"end":{"line":18,"column":34,"offset":435},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"To run, use ","position":{"start":{"line":20,"column":1,"offset":437},"end":{"line":20,"column":13,"offset":449},"indent":[]}},{"type":"inlineCode","value":"helm init","position":{"start":{"line":20,"column":13,"offset":449},"end":{"line":20,"column":24,"offset":460},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":20,"column":24,"offset":460},"end":{"line":20,"column":25,"offset":461},"indent":[]}}],"position":{"start":{"line":20,"column":1,"offset":437},"end":{"line":20,"column":25,"offset":461},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"This will installer Tiller","position":{"start":{"line":22,"column":3,"offset":465},"end":{"line":22,"column":29,"offset":491},"indent":[]}}],"position":{"start":{"line":22,"column":3,"offset":465},"end":{"line":22,"column":29,"offset":491},"indent":[]}}],"position":{"start":{"line":22,"column":1,"offset":463},"end":{"line":22,"column":29,"offset":491},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"If you have RBAC installed (recent clusters have it enabled by default), you'll also need to add a ServiceAccount and RBAC rules.","position":{"start":{"line":23,"column":3,"offset":494},"end":{"line":23,"column":132,"offset":623},"indent":[]}}],"position":{"start":{"line":23,"column":3,"offset":494},"end":{"line":23,"column":132,"offset":623},"indent":[]}}],"position":{"start":{"line":23,"column":1,"offset":492},"end":{"line":23,"column":132,"offset":623},"indent":[]}}],"position":{"start":{"line":22,"column":1,"offset":463},"end":{"line":23,"column":132,"offset":623},"indent":[1]}},{"type":"paragraph","children":[{"type":"text","value":"Helm uses a packaging format call ","position":{"start":{"line":25,"column":1,"offset":625},"end":{"line":25,"column":35,"offset":659},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"charts","position":{"start":{"line":25,"column":37,"offset":661},"end":{"line":25,"column":43,"offset":667},"indent":[]}}],"position":{"start":{"line":25,"column":35,"offset":659},"end":{"line":25,"column":45,"offset":669},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":25,"column":45,"offset":669},"end":{"line":25,"column":46,"offset":670},"indent":[]}}],"position":{"start":{"line":25,"column":1,"offset":625},"end":{"line":25,"column":46,"offset":670},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"A chart is a collection of files that describe a set of Kubernetes resources.","position":{"start":{"line":27,"column":3,"offset":674},"end":{"line":27,"column":80,"offset":751},"indent":[]}}],"position":{"start":{"line":27,"column":3,"offset":674},"end":{"line":27,"column":80,"offset":751},"indent":[]}}],"position":{"start":{"line":27,"column":1,"offset":672},"end":{"line":27,"column":80,"offset":751},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"A single chart can deploy an app, a piece of software or a database.","position":{"start":{"line":28,"column":3,"offset":754},"end":{"line":28,"column":71,"offset":822},"indent":[]}}],"position":{"start":{"line":28,"column":3,"offset":754},"end":{"line":28,"column":71,"offset":822},"indent":[]}}],"position":{"start":{"line":28,"column":1,"offset":752},"end":{"line":28,"column":71,"offset":822},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"It can have depencies ie Wordpress chart requires mysql chart.","position":{"start":{"line":29,"column":3,"offset":825},"end":{"line":29,"column":65,"offset":887},"indent":[]}}],"position":{"start":{"line":29,"column":3,"offset":825},"end":{"line":29,"column":65,"offset":887},"indent":[]}}],"position":{"start":{"line":29,"column":1,"offset":823},"end":{"line":29,"column":65,"offset":887},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"You can also write your own chart.","position":{"start":{"line":30,"column":3,"offset":890},"end":{"line":30,"column":37,"offset":924},"indent":[]}}],"position":{"start":{"line":30,"column":3,"offset":890},"end":{"line":30,"column":37,"offset":924},"indent":[]}}],"position":{"start":{"line":30,"column":1,"offset":888},"end":{"line":30,"column":37,"offset":924},"indent":[]}}],"position":{"start":{"line":27,"column":1,"offset":672},"end":{"line":30,"column":37,"offset":924},"indent":[1,1,1]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Helm commands","position":{"start":{"line":32,"column":5,"offset":930},"end":{"line":32,"column":18,"offset":943},"indent":[]}}],"position":{"start":{"line":32,"column":1,"offset":926},"end":{"line":32,"column":18,"offset":943},"indent":[]}},{"type":"table","align":[null,null],"children":[{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"Command","position":{"start":{"line":34,"column":3,"offset":947},"end":{"line":34,"column":10,"offset":954},"indent":[]}}],"position":{"start":{"line":34,"column":3,"offset":947},"end":{"line":34,"column":50,"offset":994},"indent":[]}},{"type":"tableCell","children":[{"type":"text","value":"Description","position":{"start":{"line":34,"column":53,"offset":997},"end":{"line":34,"column":64,"offset":1008},"indent":[]}}],"position":{"start":{"line":34,"column":53,"offset":997},"end":{"line":34,"column":93,"offset":1037},"indent":[]}}],"position":{"start":{"line":34,"column":1,"offset":945},"end":{"line":34,"column":95,"offset":1039},"indent":[]}},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"helm init","position":{"start":{"line":36,"column":3,"offset":1137},"end":{"line":36,"column":12,"offset":1146},"indent":[]}}],"position":{"start":{"line":36,"column":3,"offset":1137},"end":{"line":36,"column":50,"offset":1184},"indent":[]}},{"type":"tableCell","children":[{"type":"text","value":"Install tiller on the cluser","position":{"start":{"line":36,"column":53,"offset":1187},"end":{"line":36,"column":81,"offset":1215},"indent":[]}}],"position":{"start":{"line":36,"column":53,"offset":1187},"end":{"line":36,"column":93,"offset":1227},"indent":[]}}],"position":{"start":{"line":36,"column":1,"offset":1135},"end":{"line":36,"column":95,"offset":1229},"indent":[]}},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"helm reset","position":{"start":{"line":37,"column":3,"offset":1232},"end":{"line":37,"column":13,"offset":1242},"indent":[]}}],"position":{"start":{"line":37,"column":3,"offset":1232},"end":{"line":37,"column":50,"offset":1279},"indent":[]}},{"type":"tableCell","children":[{"type":"text","value":"Remove tiller","position":{"start":{"line":37,"column":53,"offset":1282},"end":{"line":37,"column":66,"offset":1295},"indent":[]}}],"position":{"start":{"line":37,"column":53,"offset":1282},"end":{"line":37,"column":93,"offset":1322},"indent":[]}}],"position":{"start":{"line":37,"column":1,"offset":1230},"end":{"line":37,"column":95,"offset":1324},"indent":[]}},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"helm install ","position":{"start":{"line":38,"column":3,"offset":1327},"end":{"line":38,"column":16,"offset":1340},"indent":[]}},{"type":"inlineCode","value":"<CHART>","position":{"start":{"line":38,"column":16,"offset":1340},"end":{"line":38,"column":25,"offset":1349},"indent":[]}}],"position":{"start":{"line":38,"column":3,"offset":1327},"end":{"line":38,"column":50,"offset":1374},"indent":[]}},{"type":"tableCell","children":[{"type":"text","value":"Install chart","position":{"start":{"line":38,"column":53,"offset":1377},"end":{"line":38,"column":66,"offset":1390},"indent":[]}}],"position":{"start":{"line":38,"column":53,"offset":1377},"end":{"line":38,"column":93,"offset":1417},"indent":[]}}],"position":{"start":{"line":38,"column":1,"offset":1325},"end":{"line":38,"column":95,"offset":1419},"indent":[]}},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"helm search ","position":{"start":{"line":39,"column":3,"offset":1422},"end":{"line":39,"column":15,"offset":1434},"indent":[]}},{"type":"inlineCode","value":"<CHART>","position":{"start":{"line":39,"column":15,"offset":1434},"end":{"line":39,"column":24,"offset":1443},"indent":[]}}],"position":{"start":{"line":39,"column":3,"offset":1422},"end":{"line":39,"column":50,"offset":1469},"indent":[]}},{"type":"tableCell","children":[{"type":"text","value":"Searches for chart","position":{"start":{"line":39,"column":53,"offset":1472},"end":{"line":39,"column":71,"offset":1490},"indent":[]}}],"position":{"start":{"line":39,"column":53,"offset":1472},"end":{"line":39,"column":93,"offset":1512},"indent":[]}}],"position":{"start":{"line":39,"column":1,"offset":1420},"end":{"line":39,"column":95,"offset":1514},"indent":[]}},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"helm search redis","position":{"start":{"line":40,"column":3,"offset":1517},"end":{"line":40,"column":20,"offset":1534},"indent":[]}}],"position":{"start":{"line":40,"column":3,"offset":1517},"end":{"line":40,"column":50,"offset":1564},"indent":[]}},{"type":"tableCell","children":[{"type":"text","value":"Looks for Redis chart","position":{"start":{"line":40,"column":53,"offset":1567},"end":{"line":40,"column":74,"offset":1588},"indent":[]}}],"position":{"start":{"line":40,"column":53,"offset":1567},"end":{"line":40,"column":93,"offset":1607},"indent":[]}}],"position":{"start":{"line":40,"column":1,"offset":1515},"end":{"line":40,"column":95,"offset":1609},"indent":[]}},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"helm install --name myredis stable/redis","position":{"start":{"line":41,"column":3,"offset":1612},"end":{"line":41,"column":43,"offset":1652},"indent":[]}}],"position":{"start":{"line":41,"column":3,"offset":1612},"end":{"line":41,"column":50,"offset":1659},"indent":[]}},{"type":"tableCell","children":[{"type":"text","value":"Installs Redis chart found under myredis","position":{"start":{"line":41,"column":53,"offset":1662},"end":{"line":41,"column":93,"offset":1702},"indent":[]}}],"position":{"start":{"line":41,"column":53,"offset":1662},"end":{"line":41,"column":93,"offset":1702},"indent":[]}}],"position":{"start":{"line":41,"column":1,"offset":1610},"end":{"line":41,"column":95,"offset":1704},"indent":[]}},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"helm delete myredis","position":{"start":{"line":42,"column":3,"offset":1707},"end":{"line":42,"column":22,"offset":1726},"indent":[]}}],"position":{"start":{"line":42,"column":3,"offset":1707},"end":{"line":42,"column":50,"offset":1754},"indent":[]}},{"type":"tableCell","children":[{"type":"text","value":"Delete Redis install named myredis","position":{"start":{"line":42,"column":53,"offset":1757},"end":{"line":42,"column":87,"offset":1791},"indent":[]}}],"position":{"start":{"line":42,"column":53,"offset":1757},"end":{"line":42,"column":93,"offset":1797},"indent":[]}}],"position":{"start":{"line":42,"column":1,"offset":1705},"end":{"line":42,"column":95,"offset":1799},"indent":[]}},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"helm create ","position":{"start":{"line":43,"column":3,"offset":1802},"end":{"line":43,"column":15,"offset":1814},"indent":[]}},{"type":"inlineCode","value":"<CHART_NAME>","position":{"start":{"line":43,"column":15,"offset":1814},"end":{"line":43,"column":29,"offset":1828},"indent":[]}}],"position":{"start":{"line":43,"column":3,"offset":1802},"end":{"line":43,"column":50,"offset":1849},"indent":[]}},{"type":"tableCell","children":[{"type":"text","value":"Create your own chart","position":{"start":{"line":43,"column":53,"offset":1852},"end":{"line":43,"column":74,"offset":1873},"indent":[]}}],"position":{"start":{"line":43,"column":53,"offset":1852},"end":{"line":43,"column":93,"offset":1892},"indent":[]}}],"position":{"start":{"line":43,"column":1,"offset":1800},"end":{"line":43,"column":95,"offset":1894},"indent":[]}},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"helm update ","position":{"start":{"line":44,"column":3,"offset":1897},"end":{"line":44,"column":15,"offset":1909},"indent":[]}},{"type":"inlineCode","value":"<OPTIONS>","position":{"start":{"line":44,"column":15,"offset":1909},"end":{"line":44,"column":26,"offset":1920},"indent":[]}},{"type":"text","value":" ","position":{"start":{"line":44,"column":26,"offset":1920},"end":{"line":44,"column":27,"offset":1921},"indent":[]}},{"type":"inlineCode","value":"<CHART>","position":{"start":{"line":44,"column":27,"offset":1921},"end":{"line":44,"column":36,"offset":1930},"indent":[]}},{"type":"text","value":" path/to/chart","position":{"start":{"line":44,"column":36,"offset":1930},"end":{"line":44,"column":50,"offset":1944},"indent":[]}}],"position":{"start":{"line":44,"column":3,"offset":1897},"end":{"line":44,"column":50,"offset":1944},"indent":[]}},{"type":"tableCell","children":[{"type":"text","value":"Update the chart","position":{"start":{"line":44,"column":53,"offset":1947},"end":{"line":44,"column":69,"offset":1963},"indent":[]}}],"position":{"start":{"line":44,"column":53,"offset":1947},"end":{"line":44,"column":93,"offset":1987},"indent":[]}}],"position":{"start":{"line":44,"column":1,"offset":1895},"end":{"line":44,"column":95,"offset":1989},"indent":[]}},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"helm history ","position":{"start":{"line":45,"column":3,"offset":1992},"end":{"line":45,"column":16,"offset":2005},"indent":[]}},{"type":"inlineCode","value":"<CHART_NAME>","position":{"start":{"line":45,"column":16,"offset":2005},"end":{"line":45,"column":30,"offset":2019},"indent":[]}}],"position":{"start":{"line":45,"column":3,"offset":1992},"end":{"line":45,"column":50,"offset":2039},"indent":[]}},{"type":"tableCell","children":[{"type":"text","value":"See upgrade history of chart","position":{"start":{"line":45,"column":53,"offset":2042},"end":{"line":45,"column":81,"offset":2070},"indent":[]}}],"position":{"start":{"line":45,"column":53,"offset":2042},"end":{"line":45,"column":93,"offset":2082},"indent":[]}}],"position":{"start":{"line":45,"column":1,"offset":1990},"end":{"line":45,"column":95,"offset":2084},"indent":[]}},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"helm rollback ","position":{"start":{"line":46,"column":3,"offset":2087},"end":{"line":46,"column":17,"offset":2101},"indent":[]}},{"type":"inlineCode","value":"<CHART_NAME>","position":{"start":{"line":46,"column":17,"offset":2101},"end":{"line":46,"column":31,"offset":2115},"indent":[]}},{"type":"text","value":" ","position":{"start":{"line":46,"column":31,"offset":2115},"end":{"line":46,"column":32,"offset":2116},"indent":[]}},{"type":"inlineCode","value":"<REVISION>","position":{"start":{"line":46,"column":32,"offset":2116},"end":{"line":46,"column":44,"offset":2128},"indent":[]}}],"position":{"start":{"line":46,"column":3,"offset":2087},"end":{"line":46,"column":50,"offset":2134},"indent":[]}},{"type":"tableCell","children":[{"type":"text","value":"Rollback to version","position":{"start":{"line":46,"column":53,"offset":2137},"end":{"line":46,"column":72,"offset":2156},"indent":[]}}],"position":{"start":{"line":46,"column":53,"offset":2137},"end":{"line":46,"column":93,"offset":2177},"indent":[]}}],"position":{"start":{"line":46,"column":1,"offset":2085},"end":{"line":46,"column":95,"offset":2179},"indent":[]}},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"helm list","position":{"start":{"line":47,"column":3,"offset":2182},"end":{"line":47,"column":12,"offset":2191},"indent":[]}}],"position":{"start":{"line":47,"column":3,"offset":2182},"end":{"line":47,"column":50,"offset":2229},"indent":[]}},{"type":"tableCell","children":[{"type":"text","value":"List running charts","position":{"start":{"line":47,"column":53,"offset":2232},"end":{"line":47,"column":72,"offset":2251},"indent":[]}}],"position":{"start":{"line":47,"column":53,"offset":2232},"end":{"line":47,"column":93,"offset":2272},"indent":[]}}],"position":{"start":{"line":47,"column":1,"offset":2180},"end":{"line":47,"column":95,"offset":2274},"indent":[]}},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"helm list --all","position":{"start":{"line":48,"column":3,"offset":2277},"end":{"line":48,"column":18,"offset":2292},"indent":[]}}],"position":{"start":{"line":48,"column":3,"offset":2277},"end":{"line":48,"column":50,"offset":2324},"indent":[]}},{"type":"tableCell","children":[{"type":"text","value":"List all charts that have ran","position":{"start":{"line":48,"column":53,"offset":2327},"end":{"line":48,"column":82,"offset":2356},"indent":[]}}],"position":{"start":{"line":48,"column":53,"offset":2327},"end":{"line":48,"column":93,"offset":2367},"indent":[]}}],"position":{"start":{"line":48,"column":1,"offset":2275},"end":{"line":48,"column":95,"offset":2369},"indent":[]}},{"type":"tableRow","children":[{"type":"tableCell","children":[{"type":"text","value":"helm delete ","position":{"start":{"line":49,"column":3,"offset":2372},"end":{"line":49,"column":15,"offset":2384},"indent":[]}},{"type":"inlineCode","value":"<CHART_NAME>","position":{"start":{"line":49,"column":15,"offset":2384},"end":{"line":49,"column":29,"offset":2398},"indent":[]}},{"type":"text","value":" --purge","position":{"start":{"line":49,"column":29,"offset":2398},"end":{"line":49,"column":37,"offset":2406},"indent":[]}}],"position":{"start":{"line":49,"column":3,"offset":2372},"end":{"line":49,"column":50,"offset":2419},"indent":[]}},{"type":"tableCell","children":[{"type":"text","value":"Release deleted chart","position":{"start":{"line":49,"column":53,"offset":2422},"end":{"line":49,"column":74,"offset":2443},"indent":[]}}],"position":{"start":{"line":49,"column":53,"offset":2422},"end":{"line":49,"column":93,"offset":2462},"indent":[]}}],"position":{"start":{"line":49,"column":1,"offset":2370},"end":{"line":49,"column":95,"offset":2464},"indent":[]}}],"position":{"start":{"line":34,"column":1,"offset":945},"end":{"line":49,"column":95,"offset":2464},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Installing Helm","position":{"start":{"line":51,"column":5,"offset":2470},"end":{"line":51,"column":20,"offset":2485},"indent":[]}}],"position":{"start":{"line":51,"column":1,"offset":2466},"end":{"line":51,"column":20,"offset":2485},"indent":[]}},{"type":"code","lang":"shell","meta":null,"value":"curl https://raw.githubusercontent.com/helm/helm/master/scripts/get > get_helm.sh\nchmod 700 get_helm.sh\n./get_helm.sh","position":{"start":{"line":53,"column":1,"offset":2487},"end":{"line":57,"column":4,"offset":2617},"indent":[1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Alternatively:","position":{"start":{"line":59,"column":1,"offset":2619},"end":{"line":59,"column":15,"offset":2633},"indent":[]}}],"position":{"start":{"line":59,"column":1,"offset":2619},"end":{"line":59,"column":15,"offset":2633},"indent":[]}},{"type":"code","lang":"shell","meta":null,"value":"curl https://raw.githubusercontent.com/helm/helm/master/scripts/get | bash","position":{"start":{"line":61,"column":1,"offset":2635},"end":{"line":63,"column":4,"offset":2722},"indent":[1,1]}},{"type":"heading","depth":4,"children":[{"type":"text","value":"Linux Distro Install","position":{"start":{"line":65,"column":6,"offset":2729},"end":{"line":65,"column":26,"offset":2749},"indent":[]}}],"position":{"start":{"line":65,"column":1,"offset":2724},"end":{"line":65,"column":26,"offset":2749},"indent":[]}},{"type":"code","lang":"shell","meta":null,"value":"wget https://kubernetes-helm.storage.googleapis.com/helm-v2.11.0-linux-amd64.tar.gz\ntar -xzvf helm-v2.11.0-linux-amd64.tar.gz\nsudo mv linux-amd64/helm /usr/local/bin/helm","position":{"start":{"line":67,"column":1,"offset":2751},"end":{"line":71,"column":4,"offset":2934},"indent":[1,1,1,1]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"Adding to cluster","position":{"start":{"line":73,"column":5,"offset":2940},"end":{"line":73,"column":22,"offset":2957},"indent":[]}}],"position":{"start":{"line":73,"column":1,"offset":2936},"end":{"line":73,"column":22,"offset":2957},"indent":[]}},{"type":"code","lang":"yaml","meta":null,"value":"# helm-rbac.yaml\napiVersion: v1\nkind: ServiceAccount\nmetadata:\n  name: tiller\n  namespace: kube-system\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRoleBinding\nmetadata:\n  name: tiller\nroleRef:\n  apiGroup: rbac.authorization.k8s.io\n  kind: ClusterRole\n  name: cluster-admin\nsubjects:\n  - kind: ServiceAccount\n    name: tiller\n    namespace: kube-system","position":{"start":{"line":75,"column":1,"offset":2959},"end":{"line":95,"column":4,"offset":3336},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"code","lang":"shell","meta":null,"value":"kubectl apply -f helm-rbac.yaml\nhelm init --service-account tiller","position":{"start":{"line":97,"column":1,"offset":3338},"end":{"line":100,"column":4,"offset":3417},"indent":[1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"5.2 Creating your own helm charts","position":{"start":{"line":102,"column":4,"offset":3422},"end":{"line":102,"column":37,"offset":3455},"indent":[]}}],"position":{"start":{"line":102,"column":1,"offset":3419},"end":{"line":102,"column":37,"offset":3455},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"This is the recommended way to deploy applications.","position":{"start":{"line":104,"column":1,"offset":3457},"end":{"line":104,"column":52,"offset":3508},"indent":[]}}],"position":{"start":{"line":104,"column":1,"offset":3457},"end":{"line":104,"column":52,"offset":3508},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Packaging the app allows you to deploy the app in 1 command.","position":{"start":{"line":106,"column":3,"offset":3512},"end":{"line":106,"column":63,"offset":3572},"indent":[]}}],"position":{"start":{"line":106,"column":3,"offset":3512},"end":{"line":106,"column":63,"offset":3572},"indent":[]}}],"position":{"start":{"line":106,"column":1,"offset":3510},"end":{"line":106,"column":63,"offset":3572},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Helm allows for upgrades and rollbacks.","position":{"start":{"line":107,"column":3,"offset":3575},"end":{"line":107,"column":42,"offset":3614},"indent":[]}}],"position":{"start":{"line":107,"column":3,"offset":3575},"end":{"line":107,"column":42,"offset":3614},"indent":[]}}],"position":{"start":{"line":107,"column":1,"offset":3573},"end":{"line":107,"column":42,"offset":3614},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Helm chart is also version controlled.","position":{"start":{"line":108,"column":3,"offset":3617},"end":{"line":108,"column":41,"offset":3655},"indent":[]}}],"position":{"start":{"line":108,"column":3,"offset":3617},"end":{"line":108,"column":41,"offset":3655},"indent":[]}}],"position":{"start":{"line":108,"column":1,"offset":3615},"end":{"line":108,"column":41,"offset":3655},"indent":[]}}],"position":{"start":{"line":106,"column":1,"offset":3510},"end":{"line":108,"column":41,"offset":3655},"indent":[1,1]}},{"type":"code","lang":"shell","meta":null,"value":"# creates director mychart/\nhelm create mychart\nls mychart\n# Displays Chart.yaml  charts  templates  values.yaml","position":{"start":{"line":110,"column":1,"offset":3657},"end":{"line":115,"column":4,"offset":3782},"indent":[1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"inlineCode","value":"values.yaml","position":{"start":{"line":117,"column":1,"offset":3784},"end":{"line":117,"column":14,"offset":3797},"indent":[]}},{"type":"text","value":" will control things such as replicas, image etc.","position":{"start":{"line":117,"column":14,"offset":3797},"end":{"line":117,"column":63,"offset":3846},"indent":[]}}],"position":{"start":{"line":117,"column":1,"offset":3784},"end":{"line":117,"column":63,"offset":3846},"indent":[]}},{"type":"code","lang":"yaml","meta":null,"value":"# Default values for test.\n# This is a YAML-formatted file.\n# Declare variables to be passed into your templates.\n\nreplicaCount: 1\n\nimage:\n  repository: nginx\n  tag: stable\n  pullPolicy: IfNotPresent\n\nnameOverride: \"\"\nfullnameOverride: \"\"\n\nservice:\n  type: ClusterIP\n  port: 80\n\ningress:\n  enabled: false\n  annotations: {}\n    # kubernetes.io/ingress.class: nginx\n    # kubernetes.io/tls-acme: \"true\"\n  paths: []\n  hosts:\n    - chart-example.local\n  tls: []\n  #  - secretName: chart-example-tls\n  #    hosts:\n  #      - chart-example.local\n\nresources: {}\n  # We usually recommend not to specify default resources and to leave this as a conscious\n  # choice for the user. This also increases chances charts run on environments with little\n  # resources, such as Minikube. If you do want to specify resources, uncomment the following\n  # lines, adjust them as necessary, and remove the curly braces after 'resources:'.\n  # limits:\n  #  cpu: 100m\n  #  memory: 128Mi\n  # requests:\n  #  cpu: 100m\n  #  memory: 128Mi\n\nnodeSelector: {}\n\ntolerations: []\n\naffinity: {}","position":{"start":{"line":119,"column":1,"offset":3848},"end":{"line":168,"column":4,"offset":4919},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Inside the ","position":{"start":{"line":170,"column":1,"offset":4921},"end":{"line":170,"column":12,"offset":4932},"indent":[]}},{"type":"inlineCode","value":"mychart/templates","position":{"start":{"line":170,"column":12,"offset":4932},"end":{"line":170,"column":31,"offset":4951},"indent":[]}},{"type":"text","value":" folder we have...","position":{"start":{"line":170,"column":31,"offset":4951},"end":{"line":170,"column":49,"offset":4969},"indent":[]}}],"position":{"start":{"line":170,"column":1,"offset":4921},"end":{"line":170,"column":49,"offset":4969},"indent":[]}},{"type":"code","lang":"shell","meta":null,"value":"ls mychart/templates\n# shows NOTES.txt  _helpers.tpl  deployment.yaml  ingress.yaml  service.yaml  tests","position":{"start":{"line":172,"column":1,"offset":4971},"end":{"line":175,"column":4,"offset":5088},"indent":[1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Looking at the ","position":{"start":{"line":177,"column":1,"offset":5090},"end":{"line":177,"column":16,"offset":5105},"indent":[]}},{"type":"inlineCode","value":"deployment.yaml","position":{"start":{"line":177,"column":16,"offset":5105},"end":{"line":177,"column":33,"offset":5122},"indent":[]}},{"type":"text","value":" we see the following:","position":{"start":{"line":177,"column":33,"offset":5122},"end":{"line":177,"column":55,"offset":5144},"indent":[]}}],"position":{"start":{"line":177,"column":1,"offset":5090},"end":{"line":177,"column":55,"offset":5144},"indent":[]}},{"type":"code","lang":"yaml","meta":null,"value":"apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: {{ include \"test.fullname\" . }}\n  labels:\n    app.kubernetes.io/name: {{ include \"test.name\" . }}\n    helm.sh/chart: {{ include \"test.chart\" . }}\n    app.kubernetes.io/instance: {{ .Release.Name }}\n    app.kubernetes.io/managed-by: {{ .Release.Service }}\nspec:\n  replicas: {{ .Values.replicaCount }}\n  selector:\n    matchLabels:\n      app.kubernetes.io/name: {{ include \"test.name\" . }}\n      app.kubernetes.io/instance: {{ .Release.Name }}\n  template:\n    metadata:\n      labels:\n        app.kubernetes.io/name: {{ include \"test.name\" . }}\n        app.kubernetes.io/instance: {{ .Release.Name }}\n    spec:\n      containers:\n        - name: {{ .Chart.Name }}\n          image: \"{{ .Values.image.repository }}:{{ .Values.image.tag }}\"\n          imagePullPolicy: {{ .Values.image.pullPolicy }}\n          ports:\n            - name: http\n              containerPort: 80\n              protocol: TCP\n          livenessProbe:\n            httpGet:\n              path: /\n              port: http\n          readinessProbe:\n            httpGet:\n              path: /\n              port: http\n          resources:\n            {{- toYaml .Values.resources | nindent 12 }}\n      {{- with .Values.nodeSelector }}\n      nodeSelector:\n        {{- toYaml . | nindent 8 }}\n      {{- end }}\n    {{- with .Values.affinity }}\n      affinity:\n        {{- toYaml . | nindent 8 }}\n    {{- end }}\n    {{- with .Values.tolerations }}\n      tolerations:\n        {{- toYaml . | nindent 8 }}\n    {{- end }}","position":{"start":{"line":179,"column":1,"offset":5146},"end":{"line":231,"column":4,"offset":6688},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"These values will be filled out when deployed.","position":{"start":{"line":233,"column":1,"offset":6690},"end":{"line":233,"column":47,"offset":6736},"indent":[]}}],"position":{"start":{"line":233,"column":1,"offset":6690},"end":{"line":233,"column":47,"offset":6736},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The spec values are generally defined by the earlier ","position":{"start":{"line":235,"column":1,"offset":6738},"end":{"line":235,"column":54,"offset":6791},"indent":[]}},{"type":"inlineCode","value":"values.yaml","position":{"start":{"line":235,"column":54,"offset":6791},"end":{"line":235,"column":67,"offset":6804},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":235,"column":67,"offset":6804},"end":{"line":235,"column":68,"offset":6805},"indent":[]}}],"position":{"start":{"line":235,"column":1,"offset":6738},"end":{"line":235,"column":68,"offset":6805},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The ","position":{"start":{"line":237,"column":1,"offset":6807},"end":{"line":237,"column":5,"offset":6811},"indent":[]}},{"type":"inlineCode","value":"mychart/service.yaml","position":{"start":{"line":237,"column":5,"offset":6811},"end":{"line":237,"column":27,"offset":6833},"indent":[]}},{"type":"text","value":" also templates how the service file will be created:","position":{"start":{"line":237,"column":27,"offset":6833},"end":{"line":237,"column":80,"offset":6886},"indent":[]}}],"position":{"start":{"line":237,"column":1,"offset":6807},"end":{"line":237,"column":80,"offset":6886},"indent":[]}},{"type":"code","lang":"yaml","meta":null,"value":"apiVersion: v1\nkind: Service\nmetadata:\n  name: {{ include \"test.fullname\" . }}\n  labels:\n    app.kubernetes.io/name: {{ include \"test.name\" . }}\n    helm.sh/chart: {{ include \"test.chart\" . }}\n    app.kubernetes.io/instance: {{ .Release.Name }}\n    app.kubernetes.io/managed-by: {{ .Release.Service }}\nspec:\n  type: {{ .Values.service.type }}\n  ports:\n    - port: {{ .Values.service.port }}\n      targetPort: http\n      protocol: TCP\n      name: http\n  selector:\n    app.kubernetes.io/name: {{ include \"test.name\" . }}\n    app.kubernetes.io/instance: {{ .Release.Name }}","position":{"start":{"line":239,"column":1,"offset":6888},"end":{"line":259,"column":4,"offset":7470},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"From here, you can directly install the helm chart using ","position":{"start":{"line":261,"column":1,"offset":7472},"end":{"line":261,"column":58,"offset":7529},"indent":[]}},{"type":"inlineCode","value":"helm install mychart/","position":{"start":{"line":261,"column":58,"offset":7529},"end":{"line":261,"column":81,"offset":7552},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":261,"column":81,"offset":7552},"end":{"line":261,"column":82,"offset":7553},"indent":[]}}],"position":{"start":{"line":261,"column":1,"offset":7472},"end":{"line":261,"column":82,"offset":7553},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Using the default chart, there is a ","position":{"start":{"line":263,"column":1,"offset":7555},"end":{"line":263,"column":37,"offset":7591},"indent":[]}},{"type":"inlineCode","value":"nginx","position":{"start":{"line":263,"column":37,"offset":7591},"end":{"line":263,"column":44,"offset":7598},"indent":[]}},{"type":"text","value":" configuration you then port forward and curl.","position":{"start":{"line":263,"column":44,"offset":7598},"end":{"line":263,"column":90,"offset":7644},"indent":[]}}],"position":{"start":{"line":263,"column":1,"offset":7555},"end":{"line":263,"column":90,"offset":7644},"indent":[]}},{"type":"code","lang":"shell","meta":null,"value":"kubectl port-forward 80:8080\n# Press ^z here\nbg # set to background\ncurl localhost:8080 \n# result should be default nginx html\nfg # bring port-forward back to foreground","position":{"start":{"line":265,"column":1,"offset":7646},"end":{"line":272,"column":4,"offset":7828},"indent":[1,1,1,1,1,1,1]}},{"type":"heading","depth":1,"children":[{"type":"text","value":"Demo with a Nodejs app","position":{"start":{"line":274,"column":3,"offset":7832},"end":{"line":274,"column":25,"offset":7854},"indent":[]}}],"position":{"start":{"line":274,"column":1,"offset":7830},"end":{"line":274,"column":25,"offset":7854},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Create a chart and update the required value for your image etc.","position":{"start":{"line":276,"column":1,"offset":7856},"end":{"line":276,"column":65,"offset":7920},"indent":[]}}],"position":{"start":{"line":276,"column":1,"offset":7856},"end":{"line":276,"column":65,"offset":7920},"indent":[]}},{"type":"code","lang":"yaml","meta":null,"value":"# Default values for test.\n# This is a YAML-formatted file.\n# Declare variables to be passed into your templates.\n\nreplicaCount: 1\n\nimage:\n  repository: okeeffed/repo\n  tag: latest\n  pullPolicy: IfNotPresent\n\n# Could also be LoadBalancer\nservice:\n  type: ClusterIP\n  port: 80\n\ningress:\n  enabled: false\n  annotations: {}\n    # kubernetes.io/ingress.class: nginx\n    # kubernetes.io/tls-acme: \"true\"\n  paths: []\n  hosts:\n    - chart-example.local\n    # this could also be whatever.domain.com\n  tls: []\n  #  - secretName: chart-example-tls\n  #    hosts:\n  #      - chart-example.local\n\nresources: {}\n  # We usually recommend not to specify default resources and to leave this as a conscious\n  # choice for the user. This also increases chances charts run on environments with little\n  # resources, such as Minikube. If you do want to specify resources, uncomment the following\n  # lines, adjust them as necessary, and remove the curly braces after 'resources:'.\n  # limits:\n  #  cpu: 100m\n  #  memory: 128Mi\n  # requests:\n  #  cpu: 100m\n  #  memory: 128Mi\n\nnodeSelector: {}\n\ntolerations: []\n\naffinity: {}\n\n# Here you can add dependencies","position":{"start":{"line":278,"column":1,"offset":7922},"end":{"line":328,"column":4,"offset":9069},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"If your helm has depencies, these can be defined in a ","position":{"start":{"line":330,"column":1,"offset":9071},"end":{"line":330,"column":55,"offset":9125},"indent":[]}},{"type":"inlineCode","value":"requirements.yaml","position":{"start":{"line":330,"column":55,"offset":9125},"end":{"line":330,"column":74,"offset":9144},"indent":[]}},{"type":"text","value":" file. Example:","position":{"start":{"line":330,"column":74,"offset":9144},"end":{"line":330,"column":89,"offset":9159},"indent":[]}}],"position":{"start":{"line":330,"column":1,"offset":9071},"end":{"line":330,"column":89,"offset":9159},"indent":[]}},{"type":"code","lang":"yaml","meta":null,"value":"dependencies:\n  - name: mariadb\n    version: 4.x.x\n    repository: https://kubernetes-charts.storage.googleapis.com/\n    condition: mariadb.enabled\n    tags:\n      - node-app-database","position":{"start":{"line":332,"column":1,"offset":9161},"end":{"line":340,"column":4,"offset":9356},"indent":[1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Ensure you update the chart if you need to change the ","position":{"start":{"line":342,"column":1,"offset":9358},"end":{"line":342,"column":55,"offset":9412},"indent":[]}},{"type":"inlineCode","value":"containerPort","position":{"start":{"line":342,"column":55,"offset":9412},"end":{"line":342,"column":70,"offset":9427},"indent":[]}},{"type":"text","value":" or env variables etc.","position":{"start":{"line":342,"column":70,"offset":9427},"end":{"line":342,"column":92,"offset":9449},"indent":[]}}],"position":{"start":{"line":342,"column":1,"offset":9358},"end":{"line":342,"column":92,"offset":9449},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Once the chart is up and running, you can update charts which will update the orchestration. Use ","position":{"start":{"line":344,"column":1,"offset":9451},"end":{"line":344,"column":98,"offset":9548},"indent":[]}},{"type":"inlineCode","value":"helm update <OPTIONS> <CHART> path/to/chart","position":{"start":{"line":344,"column":98,"offset":9548},"end":{"line":344,"column":143,"offset":9593},"indent":[]}}],"position":{"start":{"line":344,"column":1,"offset":9451},"end":{"line":344,"column":143,"offset":9593},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Rollbacks can easily be done as well. ","position":{"start":{"line":346,"column":1,"offset":9595},"end":{"line":346,"column":39,"offset":9633},"indent":[]}}],"position":{"start":{"line":346,"column":1,"offset":9595},"end":{"line":346,"column":39,"offset":9633},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Use ","position":{"start":{"line":348,"column":1,"offset":9635},"end":{"line":348,"column":5,"offset":9639},"indent":[]}},{"type":"inlineCode","value":"helm history <CHART>","position":{"start":{"line":348,"column":5,"offset":9639},"end":{"line":348,"column":27,"offset":9661},"indent":[]}},{"type":"text","value":" to get a history of deployments. Say we want to rollback to revision one, we can then just run ","position":{"start":{"line":348,"column":27,"offset":9661},"end":{"line":348,"column":123,"offset":9757},"indent":[]}},{"type":"inlineCode","value":"helm rollback <CHART> 1","position":{"start":{"line":348,"column":123,"offset":9757},"end":{"line":348,"column":148,"offset":9782},"indent":[]}},{"type":"text","value":". ","position":{"start":{"line":348,"column":148,"offset":9782},"end":{"line":348,"column":150,"offset":9784},"indent":[]}}],"position":{"start":{"line":348,"column":1,"offset":9635},"end":{"line":348,"column":150,"offset":9784},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"5.3 Setting up Helm Repo with S3","position":{"start":{"line":352,"column":4,"offset":9791},"end":{"line":352,"column":36,"offset":9823},"indent":[]}}],"position":{"start":{"line":352,"column":1,"offset":9788},"end":{"line":352,"column":36,"offset":9823},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"If you have charts stored on S3:","position":{"start":{"line":354,"column":1,"offset":9825},"end":{"line":354,"column":33,"offset":9857},"indent":[]}}],"position":{"start":{"line":354,"column":1,"offset":9825},"end":{"line":354,"column":33,"offset":9857},"indent":[]}},{"type":"code","lang":"shell","meta":null,"value":"# Install plugin\nhelm plugin install https://github.com/hypnoglow/helm-s3.git\n\n# Initialise s3 bucket\nhelm s3 init s3://helm-bucket/charts\n\n# Add report to helm\nhelm repo add my-charts s3://helm-bucket/charts","position":{"start":{"line":356,"column":1,"offset":9859},"end":{"line":365,"column":4,"offset":10080},"indent":[1,1,1,1,1,1,1,1,1]}},{"type":"export","value":"export const _frontmatter = {}","position":{"start":{"line":367,"column":1,"offset":10082},"end":{"line":367,"column":31,"offset":10112},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":367,"column":31,"offset":10112}}},"scopeImports":[],"scopeIdentifiers":[],"rawMDXOutput":"/* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsx mdx */\nimport DefaultLayout from \"/Users/dennis.okeeffe/Project-Imposter/developer-notes/node_modules/gatsby-theme-docz/src/base/Layout.js\"\nexport const _frontmatter = {};\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\")\n  return <div {...props}/>\n};\n\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <h1 {...{\n      \"id\": \"5-packaging-and-deploying-on-kubernetes\"\n    }}>{`5. Packaging and Deploying on Kubernetes`}</h1>\n    <h2 {...{\n      \"id\": \"51-intro-to-helm\"\n    }}>{`5.1 Intro to Helm`}</h2>\n    <p>{`Helm is the best way to find, share and use software built for Kubernetes.`}</p>\n    <ul>\n      <li parentName=\"ul\">{`Package manager for Kubernetes.`}</li>\n      <li parentName=\"ul\">{`Helps you manage Kubernetes apps.`}</li>\n      <li parentName=\"ul\">{`Maintained by CNCF.`}</li>\n    </ul>\n    <p>{`To use, download the Helm client.`}</p>\n    <p>{`To run, use `}<inlineCode parentName=\"p\">{`helm init`}</inlineCode>{`.`}</p>\n    <ul>\n      <li parentName=\"ul\">{`This will installer Tiller`}</li>\n      <li parentName=\"ul\">{`If you have RBAC installed (recent clusters have it enabled by default), you'll also need to add a ServiceAccount and RBAC rules.`}</li>\n    </ul>\n    <p>{`Helm uses a packaging format call `}<strong parentName=\"p\">{`charts`}</strong>{`.`}</p>\n    <ul>\n      <li parentName=\"ul\">{`A chart is a collection of files that describe a set of Kubernetes resources.`}</li>\n      <li parentName=\"ul\">{`A single chart can deploy an app, a piece of software or a database.`}</li>\n      <li parentName=\"ul\">{`It can have depencies ie Wordpress chart requires mysql chart.`}</li>\n      <li parentName=\"ul\">{`You can also write your own chart.`}</li>\n    </ul>\n    <h3 {...{\n      \"id\": \"helm-commands\"\n    }}>{`Helm commands`}</h3>\n    <table>\n      <thead parentName=\"table\">\n        <tr parentName=\"thead\">\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Command`}</th>\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Description`}</th>\n        </tr>\n      </thead>\n      <tbody parentName=\"table\">\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`helm init`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Install tiller on the cluser`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`helm reset`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Remove tiller`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`helm install `}<inlineCode parentName=\"td\">{`<CHART>`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Install chart`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`helm search `}<inlineCode parentName=\"td\">{`<CHART>`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Searches for chart`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`helm search redis`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Looks for Redis chart`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`helm install --name myredis stable/redis`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Installs Redis chart found under myredis`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`helm delete myredis`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Delete Redis install named myredis`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`helm create `}<inlineCode parentName=\"td\">{`<CHART_NAME>`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Create your own chart`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`helm update `}<inlineCode parentName=\"td\">{`<OPTIONS>`}</inlineCode>{` `}<inlineCode parentName=\"td\">{`<CHART>`}</inlineCode>{` path/to/chart`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Update the chart`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`helm history `}<inlineCode parentName=\"td\">{`<CHART_NAME>`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`See upgrade history of chart`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`helm rollback `}<inlineCode parentName=\"td\">{`<CHART_NAME>`}</inlineCode>{` `}<inlineCode parentName=\"td\">{`<REVISION>`}</inlineCode></td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Rollback to version`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`helm list`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`List running charts`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`helm list --all`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`List all charts that have ran`}</td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`helm delete `}<inlineCode parentName=\"td\">{`<CHART_NAME>`}</inlineCode>{` --purge`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Release deleted chart`}</td>\n        </tr>\n      </tbody>\n    </table>\n    <h3 {...{\n      \"id\": \"installing-helm\"\n    }}>{`Installing Helm`}</h3>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-shell\"\n      }}>{`curl https://raw.githubusercontent.com/helm/helm/master/scripts/get > get_helm.sh\nchmod 700 get_helm.sh\n./get_helm.sh\n`}</code></pre>\n    <p>{`Alternatively:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-shell\"\n      }}>{`curl https://raw.githubusercontent.com/helm/helm/master/scripts/get | bash\n`}</code></pre>\n    <h4 {...{\n      \"id\": \"linux-distro-install\"\n    }}>{`Linux Distro Install`}</h4>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-shell\"\n      }}>{`wget https://kubernetes-helm.storage.googleapis.com/helm-v2.11.0-linux-amd64.tar.gz\ntar -xzvf helm-v2.11.0-linux-amd64.tar.gz\nsudo mv linux-amd64/helm /usr/local/bin/helm\n`}</code></pre>\n    <h3 {...{\n      \"id\": \"adding-to-cluster\"\n    }}>{`Adding to cluster`}</h3>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-yaml\"\n      }}>{`# helm-rbac.yaml\napiVersion: v1\nkind: ServiceAccount\nmetadata:\n  name: tiller\n  namespace: kube-system\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRoleBinding\nmetadata:\n  name: tiller\nroleRef:\n  apiGroup: rbac.authorization.k8s.io\n  kind: ClusterRole\n  name: cluster-admin\nsubjects:\n  - kind: ServiceAccount\n    name: tiller\n    namespace: kube-system\n`}</code></pre>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-shell\"\n      }}>{`kubectl apply -f helm-rbac.yaml\nhelm init --service-account tiller\n`}</code></pre>\n    <h2 {...{\n      \"id\": \"52-creating-your-own-helm-charts\"\n    }}>{`5.2 Creating your own helm charts`}</h2>\n    <p>{`This is the recommended way to deploy applications.`}</p>\n    <ul>\n      <li parentName=\"ul\">{`Packaging the app allows you to deploy the app in 1 command.`}</li>\n      <li parentName=\"ul\">{`Helm allows for upgrades and rollbacks.`}</li>\n      <li parentName=\"ul\">{`Helm chart is also version controlled.`}</li>\n    </ul>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-shell\"\n      }}>{`# creates director mychart/\nhelm create mychart\nls mychart\n# Displays Chart.yaml  charts  templates  values.yaml\n`}</code></pre>\n    <p><inlineCode parentName=\"p\">{`values.yaml`}</inlineCode>{` will control things such as replicas, image etc.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-yaml\"\n      }}>{`# Default values for test.\n# This is a YAML-formatted file.\n# Declare variables to be passed into your templates.\n\nreplicaCount: 1\n\nimage:\n  repository: nginx\n  tag: stable\n  pullPolicy: IfNotPresent\n\nnameOverride: \"\"\nfullnameOverride: \"\"\n\nservice:\n  type: ClusterIP\n  port: 80\n\ningress:\n  enabled: false\n  annotations: {}\n    # kubernetes.io/ingress.class: nginx\n    # kubernetes.io/tls-acme: \"true\"\n  paths: []\n  hosts:\n    - chart-example.local\n  tls: []\n  #  - secretName: chart-example-tls\n  #    hosts:\n  #      - chart-example.local\n\nresources: {}\n  # We usually recommend not to specify default resources and to leave this as a conscious\n  # choice for the user. This also increases chances charts run on environments with little\n  # resources, such as Minikube. If you do want to specify resources, uncomment the following\n  # lines, adjust them as necessary, and remove the curly braces after 'resources:'.\n  # limits:\n  #  cpu: 100m\n  #  memory: 128Mi\n  # requests:\n  #  cpu: 100m\n  #  memory: 128Mi\n\nnodeSelector: {}\n\ntolerations: []\n\naffinity: {}\n`}</code></pre>\n    <p>{`Inside the `}<inlineCode parentName=\"p\">{`mychart/templates`}</inlineCode>{` folder we have...`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-shell\"\n      }}>{`ls mychart/templates\n# shows NOTES.txt  _helpers.tpl  deployment.yaml  ingress.yaml  service.yaml  tests\n`}</code></pre>\n    <p>{`Looking at the `}<inlineCode parentName=\"p\">{`deployment.yaml`}</inlineCode>{` we see the following:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-yaml\"\n      }}>{`apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: {{ include \"test.fullname\" . }}\n  labels:\n    app.kubernetes.io/name: {{ include \"test.name\" . }}\n    helm.sh/chart: {{ include \"test.chart\" . }}\n    app.kubernetes.io/instance: {{ .Release.Name }}\n    app.kubernetes.io/managed-by: {{ .Release.Service }}\nspec:\n  replicas: {{ .Values.replicaCount }}\n  selector:\n    matchLabels:\n      app.kubernetes.io/name: {{ include \"test.name\" . }}\n      app.kubernetes.io/instance: {{ .Release.Name }}\n  template:\n    metadata:\n      labels:\n        app.kubernetes.io/name: {{ include \"test.name\" . }}\n        app.kubernetes.io/instance: {{ .Release.Name }}\n    spec:\n      containers:\n        - name: {{ .Chart.Name }}\n          image: \"{{ .Values.image.repository }}:{{ .Values.image.tag }}\"\n          imagePullPolicy: {{ .Values.image.pullPolicy }}\n          ports:\n            - name: http\n              containerPort: 80\n              protocol: TCP\n          livenessProbe:\n            httpGet:\n              path: /\n              port: http\n          readinessProbe:\n            httpGet:\n              path: /\n              port: http\n          resources:\n            {{- toYaml .Values.resources | nindent 12 }}\n      {{- with .Values.nodeSelector }}\n      nodeSelector:\n        {{- toYaml . | nindent 8 }}\n      {{- end }}\n    {{- with .Values.affinity }}\n      affinity:\n        {{- toYaml . | nindent 8 }}\n    {{- end }}\n    {{- with .Values.tolerations }}\n      tolerations:\n        {{- toYaml . | nindent 8 }}\n    {{- end }}\n`}</code></pre>\n    <p>{`These values will be filled out when deployed.`}</p>\n    <p>{`The spec values are generally defined by the earlier `}<inlineCode parentName=\"p\">{`values.yaml`}</inlineCode>{`.`}</p>\n    <p>{`The `}<inlineCode parentName=\"p\">{`mychart/service.yaml`}</inlineCode>{` also templates how the service file will be created:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-yaml\"\n      }}>{`apiVersion: v1\nkind: Service\nmetadata:\n  name: {{ include \"test.fullname\" . }}\n  labels:\n    app.kubernetes.io/name: {{ include \"test.name\" . }}\n    helm.sh/chart: {{ include \"test.chart\" . }}\n    app.kubernetes.io/instance: {{ .Release.Name }}\n    app.kubernetes.io/managed-by: {{ .Release.Service }}\nspec:\n  type: {{ .Values.service.type }}\n  ports:\n    - port: {{ .Values.service.port }}\n      targetPort: http\n      protocol: TCP\n      name: http\n  selector:\n    app.kubernetes.io/name: {{ include \"test.name\" . }}\n    app.kubernetes.io/instance: {{ .Release.Name }}\n`}</code></pre>\n    <p>{`From here, you can directly install the helm chart using `}<inlineCode parentName=\"p\">{`helm install mychart/`}</inlineCode>{`.`}</p>\n    <p>{`Using the default chart, there is a `}<inlineCode parentName=\"p\">{`nginx`}</inlineCode>{` configuration you then port forward and curl.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-shell\"\n      }}>{`kubectl port-forward 80:8080\n# Press ^z here\nbg # set to background\ncurl localhost:8080 \n# result should be default nginx html\nfg # bring port-forward back to foreground\n`}</code></pre>\n    <h1 {...{\n      \"id\": \"demo-with-a-nodejs-app\"\n    }}>{`Demo with a Nodejs app`}</h1>\n    <p>{`Create a chart and update the required value for your image etc.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-yaml\"\n      }}>{`# Default values for test.\n# This is a YAML-formatted file.\n# Declare variables to be passed into your templates.\n\nreplicaCount: 1\n\nimage:\n  repository: okeeffed/repo\n  tag: latest\n  pullPolicy: IfNotPresent\n\n# Could also be LoadBalancer\nservice:\n  type: ClusterIP\n  port: 80\n\ningress:\n  enabled: false\n  annotations: {}\n    # kubernetes.io/ingress.class: nginx\n    # kubernetes.io/tls-acme: \"true\"\n  paths: []\n  hosts:\n    - chart-example.local\n    # this could also be whatever.domain.com\n  tls: []\n  #  - secretName: chart-example-tls\n  #    hosts:\n  #      - chart-example.local\n\nresources: {}\n  # We usually recommend not to specify default resources and to leave this as a conscious\n  # choice for the user. This also increases chances charts run on environments with little\n  # resources, such as Minikube. If you do want to specify resources, uncomment the following\n  # lines, adjust them as necessary, and remove the curly braces after 'resources:'.\n  # limits:\n  #  cpu: 100m\n  #  memory: 128Mi\n  # requests:\n  #  cpu: 100m\n  #  memory: 128Mi\n\nnodeSelector: {}\n\ntolerations: []\n\naffinity: {}\n\n# Here you can add dependencies\n`}</code></pre>\n    <p>{`If your helm has depencies, these can be defined in a `}<inlineCode parentName=\"p\">{`requirements.yaml`}</inlineCode>{` file. Example:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-yaml\"\n      }}>{`dependencies:\n  - name: mariadb\n    version: 4.x.x\n    repository: https://kubernetes-charts.storage.googleapis.com/\n    condition: mariadb.enabled\n    tags:\n      - node-app-database\n`}</code></pre>\n    <p>{`Ensure you update the chart if you need to change the `}<inlineCode parentName=\"p\">{`containerPort`}</inlineCode>{` or env variables etc.`}</p>\n    <p>{`Once the chart is up and running, you can update charts which will update the orchestration. Use `}<inlineCode parentName=\"p\">{`helm update <OPTIONS> <CHART> path/to/chart`}</inlineCode></p>\n    <p>{`Rollbacks can easily be done as well. `}</p>\n    <p>{`Use `}<inlineCode parentName=\"p\">{`helm history <CHART>`}</inlineCode>{` to get a history of deployments. Say we want to rollback to revision one, we can then just run `}<inlineCode parentName=\"p\">{`helm rollback <CHART> 1`}</inlineCode>{`. `}</p>\n    <h2 {...{\n      \"id\": \"53-setting-up-helm-repo-with-s3\"\n    }}>{`5.3 Setting up Helm Repo with S3`}</h2>\n    <p>{`If you have charts stored on S3:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-shell\"\n      }}>{`# Install plugin\nhelm plugin install https://github.com/hypnoglow/helm-s3.git\n\n# Initialise s3 bucket\nhelm s3 init s3://helm-bucket/charts\n\n# Add report to helm\nhelm repo add my-charts s3://helm-bucket/charts\n`}</code></pre>\n\n    </MDXLayout>;\n}\n\n;\nMDXContent.isMDXComponent = true;"}}