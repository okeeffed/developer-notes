(window.webpackJsonp=window.webpackJsonp||[]).push([[360],{C9Vr:function(e,t,n){"use strict";n.r(t),n.d(t,"_frontmatter",(function(){return c})),n.d(t,"default",(function(){return o}));n("1c7q"),n("abGl"),n("gZHo"),n("Fdmb"),n("Ir+3"),n("2mQt"),n("mXGw");var a=n("/FXl"),l=n("TjRS");n("aD51");function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}var c={};void 0!==c&&c&&c===Object(c)&&Object.isExtensible(c)&&!c.hasOwnProperty("__filemeta")&&Object.defineProperty(c,"__filemeta",{configurable:!0,value:{name:"_frontmatter",filename:"manual/Kubernetes/EKS-Ctl.md"}});var b={_frontmatter:c},s=l.a;function o(e){var t=e.components,n=function(e,t){if(null==e)return{};var n,a,l={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(l[n]=e[n]);return l}(e,["components"]);return Object(a.b)(s,r({},b,n,{components:t,mdxType:"MDXLayout"}),Object(a.b)("h1",{id:"eksctl"},"eksctl"),Object(a.b)("p",null,Object(a.b)("a",r({parentName:"p"},{href:"https://eksctl.io/"}),"https://eksctl.io/")),Object(a.b)("h2",{id:"tldr"},"tl;dr"),Object(a.b)("h3",{id:"clusters"},"Clusters"),Object(a.b)("table",null,Object(a.b)("thead",{parentName:"table"},Object(a.b)("tr",{parentName:"thead"},Object(a.b)("th",r({parentName:"tr"},{align:null}),"Action"),Object(a.b)("th",r({parentName:"tr"},{align:null}),"Command"))),Object(a.b)("tbody",{parentName:"table"},Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",r({parentName:"tr"},{align:null}),"Get cluster"),Object(a.b)("td",r({parentName:"tr"},{align:null}),Object(a.b)("inlineCode",{parentName:"td"},"eksctl get cluster [--name=<name>] [--region=<region>]"))),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",r({parentName:"tr"},{align:null}),"Create cluster"),Object(a.b)("td",r({parentName:"tr"},{align:null}),Object(a.b)("inlineCode",{parentName:"td"},"eksctl create cluster --name=cluster-1 --nodes=4"))),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",r({parentName:"tr"},{align:null}),"Write kubeconfig"),Object(a.b)("td",r({parentName:"tr"},{align:null}),Object(a.b)("inlineCode",{parentName:"td"},"eksctl utils write-kubeconfig --name=<name> [--kubeconfig=<path>] [--set-kubeconfig-context=<bool>]"))),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",r({parentName:"tr"},{align:null}),"Delete cluster"),Object(a.b)("td",r({parentName:"tr"},{align:null}),Object(a.b)("inlineCode",{parentName:"td"},"eksctl delete cluster --name=<name> [--region=<region>]"))))),Object(a.b)("p",null,"eksctl create cluster --name=cluster-3 --nodes=4 --auto-kubeconfig"),Object(a.b)("table",null,Object(a.b)("thead",{parentName:"table"},Object(a.b)("tr",{parentName:"thead"},Object(a.b)("th",r({parentName:"tr"},{align:null}),"Action"),Object(a.b)("th",r({parentName:"tr"},{align:null}),"Flag"),Object(a.b)("th",r({parentName:"tr"},{align:null}),"Example"))),Object(a.b)("tbody",{parentName:"table"},Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",r({parentName:"tr"},{align:null}),"Name the cluster"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"--name"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"eksctl create cluster --name=cluster-3")),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",r({parentName:"tr"},{align:null}),"Set default node count"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"--nodes"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"eksctl create cluster --nodes=4")),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",r({parentName:"tr"},{align:null}),"Auto configure kubectl"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"--auto-kubeconfig"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"eksctl create cluster --auto-kubeconfig")),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",r({parentName:"tr"},{align:null}),"Use an auth scaling group"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"--nodes-min, --nodes-max"),Object(a.b)("td",r({parentName:"tr"},{align:null}),"eksctl create cluster --nodes-min=3 --nodes-max=5")))),Object(a.b)("h3",{id:"node-groups"},"Node Groups"),Object(a.b)("table",null,Object(a.b)("thead",{parentName:"table"},Object(a.b)("tr",{parentName:"thead"},Object(a.b)("th",r({parentName:"tr"},{align:null}),"Action"),Object(a.b)("th",r({parentName:"tr"},{align:null}),"Command"))),Object(a.b)("tbody",{parentName:"table"},Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",r({parentName:"tr"},{align:null}),"Get nodegroup"),Object(a.b)("td",r({parentName:"tr"},{align:null}),Object(a.b)("inlineCode",{parentName:"td"},"eksctl get nodegroup --cluster=<clusterName> [--name=<nodegroupName>]"))),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",r({parentName:"tr"},{align:null}),"Create nodegroup"),Object(a.b)("td",r({parentName:"tr"},{align:null}),Object(a.b)("inlineCode",{parentName:"td"},"eksctl create nodegroup --cluster=<clusterName> [--name=<nodegroupName>]"))),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",r({parentName:"tr"},{align:null}),"Scale nodegroup"),Object(a.b)("td",r({parentName:"tr"},{align:null}),Object(a.b)("inlineCode",{parentName:"td"},"eksctl scale nodegroup --cluster=cluster-1 --nodes=5 ng-a345f4e1"))),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",r({parentName:"tr"},{align:null}),"Delete nodegroup"),Object(a.b)("td",r({parentName:"tr"},{align:null}),Object(a.b)("inlineCode",{parentName:"td"},"eksctl delete nodegroup --cluster=<clusterName> --nodes=<desiredCount> --name=<nodegroupName>"))),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",r({parentName:"tr"},{align:null}),"SSH Access Flag"),Object(a.b)("td",r({parentName:"tr"},{align:null}),Object(a.b)("inlineCode",{parentName:"td"},"--ssh-access"))),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",r({parentName:"tr"},{align:null}),"Full ECR Access"),Object(a.b)("td",r({parentName:"tr"},{align:null}),Object(a.b)("inlineCode",{parentName:"td"},"--full-ecr-access"))),Object(a.b)("tr",{parentName:"tbody"},Object(a.b)("td",r({parentName:"tr"},{align:null}),"Enable autoscaling"),Object(a.b)("td",r({parentName:"tr"},{align:null}),Object(a.b)("inlineCode",{parentName:"td"},"--asg-access"))))),Object(a.b)("p",null,"Once clsuter is running, you'll need to add the autoscaler yourself. See ",Object(a.b)("a",r({parentName:"p"},{href:"https://github.com/kubernetes/autoscaler/blob/master/cluster-autoscaler/cloudprovider/aws/README.md"}),"https://github.com/kubernetes/autoscaler/blob/master/cluster-autoscaler/cloudprovider/aws/README.md"),"."),Object(a.b)("h3",{id:"creating-a-cluster-using-a-config-file-instead-of-flags"},"Creating a cluster using a config file instead of flags"),Object(a.b)("p",null,"You can create a cluster using a config file instead of flags."),Object(a.b)("p",null,"First, create cluster.yaml file:"),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{className:"language-yaml"}),"apiVersion: eksctl.io/v1alpha3\nkind: ClusterConfig\n\nmetadata:\n  name: basic-cluster\n  region: eu-north-1\n\nnodeGroups:\n  - name: ng-1\n    instanceType: m5.large\n    desiredCapacity: 10\n")),Object(a.b)("p",null,"Next, run this command:"),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{className:"language-shell"}),"eksctl create cluster -f cluster.yaml\n")),Object(a.b)("p",null,"This will create a cluster as described."),Object(a.b)("p",null,"If you needed to use an existing VPC, you can use a config file like this:"),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{className:"language-yaml"}),"apiVersion: eksctl.io/v1alpha3\nkind: ClusterConfig\n\nmetadata:\n  name: cluster-in-existing-vpc\n  region: eu-north-1\n\nvpc:\n  subnets:\n    private:\n      eu-north-1a: {id: subnet-0ff156e0c4a6d300c}\n      eu-north-1b: {id: subnet-0549cdab573695c03}\n      eu-north-1c: {id: subnet-0426fb4a607393184}\n\nnodeGroups:\n  - name: ng-1-workers\n    labels: {role: workers}\n    instanceType: m5.xlarge\n    desiredCapacity: 10\n    privateNetworking: true\n  - name: ng-2-builders\n    labels: {role: builders}\n    instanceType: m5.2xlarge\n    desiredCapacity: 2\n    privateNetworking: true\n    iam:\n      withAddonPolicies:\n        imageBuilder: true\n")),Object(a.b)("p",null,"See ",Object(a.b)("img",{alt:"examples/",src:"https://github.com/weaveworks/eksctl/tree/master/examples"})," directory for more sample config files."),Object(a.b)("h2",{id:"usage"},"Usage"),Object(a.b)("p",null,"To download the latest release, run:"),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{className:"language-shell"}),'curl --silent --location "https://github.com/weaveworks/eksctl/releases/download/latest_release/eksctl_$(uname -s)_amd64.tar.gz" | tar xz -C /tmp\nsudo mv /tmp/eksctl /usr/local/bin\n')),Object(a.b)("p",null,"Alternatively, macOS users can use Homebrew:"),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{className:"language-shell"}),"brew install weaveworks/tap/eksctl\n")),Object(a.b)("p",null,"You will need to have AWS API credentials configured. What works for AWS CLI or any other tools (kops, Terraform etc), should be sufficient. You can use ",Object(a.b)("inlineCode",{parentName:"p"},"~/.aws/credentials")," file or environment variables. For more information read AWS documentation."),Object(a.b)("p",null,"To create a basic cluster, run:"),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{className:"language-shell"}),"eksctl create cluster\n")),Object(a.b)("p",null,"A cluster will be created with default parameters:"),Object(a.b)("ul",null,Object(a.b)("li",{parentName:"ul"},'Exciting auto-generated name, e.g. "fabulous-mushroom-1527688624"'),Object(a.b)("li",{parentName:"ul"},"2x m5.large nodes (this instance type suits most common use-cases, and is good value for money)"),Object(a.b)("li",{parentName:"ul"},"Use official AWS EKS AMI"),Object(a.b)("li",{parentName:"ul"},Object(a.b)("inlineCode",{parentName:"li"},"us-west-2")," region"),Object(a.b)("li",{parentName:"ul"},"Dedicated VPC (check your quotas)"),Object(a.b)("li",{parentName:"ul"},"Using static AMI resolver")),Object(a.b)("h3",{id:"example-output"},"Example output"),Object(a.b)("pre",null,Object(a.b)("code",r({parentName:"pre"},{className:"language-shell"}),'$ eksctl create cluster\n[ℹ]  using region us-west-2\n[ℹ]  setting availability zones to [us-west-2c us-west-2a us-west-2b]\n[ℹ]  subnets for us-west-2c - public:192.168.0.0/19 private:192.168.96.0/19\n[ℹ]  subnets for us-west-2a - public:192.168.32.0/19 private:192.168.128.0/19\n[ℹ]  subnets for us-west-2b - public:192.168.64.0/19 private:192.168.160.0/19\n[ℹ]  using "ami-0ce0ec06e682ee10e" for nodes\n[ℹ]  creating EKS cluster "floral-unicorn-1540567338" in "us-west-2" region\n[ℹ]  will create 2 separate CloudFormation stacks for cluster itself and the initial nodegroup\n[ℹ]  if you encounter any issues, check CloudFormation console or try \'eksctl utils describe-stacks --region=us-west-2 --name=floral-unicorn-1540567338\'\n[ℹ]  creating cluster stack "eksctl-floral-unicorn-1540567338-cluster"\n[ℹ]  creating nodegroup stack "eksctl-floral-unicorn-1540567338-nodegroup-ng-39d54824"\n[✔]  all EKS cluster resource for "floral-unicorn-1540567338" had been created\n[✔]  saved kubeconfig as "~/.kube/config"\n[ℹ]  nodegroup "ng-39d54824" has 0 nodes\n[ℹ]  waiting for at least 2 nodes to become ready\n[ℹ]  nodegroup "ng-39d54824" has 2 nodes\n[ℹ]  node "ip-192-168-71-20.us-west-2.compute.internal" is ready\n[ℹ]  node "ip-192-168-25-215.us-west-2.compute.internal" is ready\n[ℹ]  kubectl command should work with "~/.kube/config", try \'kubectl get nodes\'\n[✔]  EKS cluster "floral-unicorn-1540567338" in "us-west-2" region is ready\n$\n')))}o&&o===Object(o)&&Object.isExtensible(o)&&!o.hasOwnProperty("__filemeta")&&Object.defineProperty(o,"__filemeta",{configurable:!0,value:{name:"MDXContent",filename:"manual/Kubernetes/EKS-Ctl.md"}}),o.isMDXComponent=!0}}]);
//# sourceMappingURL=component---manual-kubernetes-eks-ctl-md-43fc142d72a2f4371f2b.js.map